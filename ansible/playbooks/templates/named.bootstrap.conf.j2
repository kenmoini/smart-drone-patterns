//==============================================================================
// Generated by Ansible
//==============================================================================

//==============================================================================
// ACLs
//==============================================================================
{% for acl in acls %}
// ACL #{{ loop.index }} - {{ acl.name }}
acl "{{ acl.name }}" {
{% for network in acl.networks %}
  {{ network }};
{% endfor %}
};

{% endfor %}

//==============================================================================
// Views
//==============================================================================

{% for view in views %}{% set viewIndex = loop.index %}
// View #{{ viewIndex }} - {{ view.name }}
view "{{ view.name }}" {
  match-clients { {% for acl in view.acls %}{{ acl }}; {% endfor %} };

{% if view.recursion %}
  recursion yes;
{% endif %}

{% if view.forwarders is defined %}
  forwarders {
{% for forwarder in view.forwarders %}
    {{ forwarder }};
{% endfor %}
  };
{% endif %}

{% if view.forwarded_zones is defined %}
{% for forwardedZone in view.forwarded_zones %}{% set forwardedZoneIndex = loop.index %}
  // Forwarded Zone #{{ forwardedZoneIndex }} - {{ forwardedZone.zone }}
  zone "{{ forwardedZone.zone }}" {
    type forward;
    forward only;
    forwarders {
{% for fwdZone in forwardedZone.forwarders %}
      {{ fwdZone }};
{% endfor %}
    };
  };

{% endfor %}
{% endif %}

{% for zone in view.zones %}{% set zoneIndex = loop.index %}
  // Authoritative Zone #{{ zoneIndex }} - {{ zone }}
  include "/var/named/config/fwd.{{ zone }}.zone.conf";

{% endfor %}

};
{% endfor %}
